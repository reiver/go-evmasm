package evmasm

import (
	"bytes"
	"strings"

	"testing"
)

func TestAssemble(t *testing.T) {

	tests := []struct{
		Code       string
		Expected []byte
	}{
		{
			Code: "push1 0x03 push1 0x02 add",
			Expected: []byte{
				0x60, 0x03, // push1 3
				0x60, 0x02, // push1 2
				0x01,       // add
			},
		},
		{
			Code: " push1 0x03 push1 0x02 add",
			Expected: []byte{
				0x60, 0x03, // push1 3
				0x60, 0x02, // push1 2
				0x01,       // add
			},
		},
		{
			Code: "push1 0x03 push1 0x02 add ",
			Expected: []byte{
				0x60, 0x03, // push1 3
				0x60, 0x02, // push1 2
				0x01,       // add
			},
		},
		{
			Code: " push1 0x03 push1 0x02 add ",
			Expected: []byte{
				0x60, 0x03, // push1 3
				0x60, 0x02, // push1 2
				0x01,       // add
			},
		},



		{
			Code: "push1  0x01",
			Expected: []byte{
				0x60, 0x01,
			},
		},
		{
			Code: "push2  0x01  0x02",
			Expected: []byte{
				0x61, 0x01, 0x02,
			},
		},
		{
			Code: "push3  0x01  0x02  0x03",
			Expected: []byte{
				0x62, 0x01, 0x02, 0x03,
			},
		},
		{
			Code: "push4  0x01  0x02  0x03  0x04",
			Expected: []byte{
				0x63, 0x01, 0x02, 0x03, 0x04,
			},
		},
		{
			Code: "push5  0x01  0x02  0x03  0x04  0x05",
			Expected: []byte{
				0x64, 0x01, 0x02, 0x03, 0x04, 0x05,
			},
		},
		{
			Code: "push6  0x01  0x02  0x03  0x04  0x05  0x06",
			Expected: []byte{
				0x65, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
			},
		},
		{
			Code: "push7  0x01  0x02  0x03  0x04  0x05  0x06  0x07",
			Expected: []byte{
				0x66, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
			},
		},
		{
			Code: "push8  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08",
			Expected: []byte{
				0x67, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,
			},
		},
		{
			Code: "push9  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09",
			Expected: []byte{
				0x68, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09,
			},
		},
		{
			Code: "push10 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a",
			Expected: []byte{
				0x69, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a,
			},
		},
		{
			Code: "push11 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b",
			Expected: []byte{
				0x6a, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b,
			},
		},
		{
			Code: "push12 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c",
			Expected: []byte{
				0x6b, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c,
			},
		},
		{
			Code: "push13 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d",
			Expected: []byte{
				0x6c, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d,
			},
		},
		{
			Code: "push14 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e",
			Expected: []byte{
				0x6d, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e,
			},
		},
		{
			Code: "push15 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f",
			Expected: []byte{
				0x6e, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,
			},
		},
		{
			Code: "push16 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10",
			Expected: []byte{
				0x6f, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10,
			},
		},
		{
			Code: "push17 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11",
			Expected: []byte{
				0x70, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11,
			},
		},
		{
			Code: "push18 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12",
			Expected: []byte{
				0x71, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12,
			},
		},
		{
			Code: "push19 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13",
			Expected: []byte{
				0x72, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13,
			},
		},
		{
			Code: "push20 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14",
			Expected: []byte{
				0x73, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14,
			},
		},
		{
			Code: "push21 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15",
			Expected: []byte{
				0x74, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15,
			},
		},
		{
			Code: "push22 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16",
			Expected: []byte{
				0x75, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16,
			},
		},
		{
			Code: "push23 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17",
			Expected: []byte{
				0x76, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
			},
		},
		{
			Code: "push24 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18",
			Expected: []byte{
				0x77, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18,
			},
		},
		{
			Code: "push25 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19",
			Expected: []byte{
				0x78, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19,
			},
		},
		{
			Code: "push26 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a",
			Expected: []byte{
				0x79, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a,
			},
		},
		{
			Code: "push27 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b",
			Expected: []byte{
				0x7a, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b,
			},
		},
		{
			Code: "push28 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c",
			Expected: []byte{
				0x7b, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c,
			},
		},
		{
			Code: "push29 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d",
			Expected: []byte{
				0x7c, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d,
			},
		},
		{
			Code: "push30 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d  0x1e",
			Expected: []byte{
				0x7d, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e,
			},
		},
		{
			Code: "push31 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d  0x1e  0x1f",
			Expected: []byte{
				0x7e, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,
			},
		},
		{
			Code: "push32 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d  0x1e  0x1f  0x20",
			Expected: []byte{
				0x7f, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f, 0x20,
			},
		},



		{
			Code: "push1  0x01                                                                                                                                                                                            add",
			Expected: []byte{
				0x60, 0x01,                                                                                                                                                                                           0x01,
			},
		},
		{
			Code: "push2  0x01  0x02                                                                                                                                                                                      add",
			Expected: []byte{
				0x61, 0x01, 0x02,                                                                                                                                                                                     0x01,
			},
		},
		{
			Code: "push3  0x01  0x02  0x03                                                                                                                                                                                add",
			Expected: []byte{
				0x62, 0x01, 0x02, 0x03,                                                                                                                                                                               0x01,
			},
		},
		{
			Code: "push4  0x01  0x02  0x03  0x04                                                                                                                                                                          add",
			Expected: []byte{
				0x63, 0x01, 0x02, 0x03, 0x04,                                                                                                                                                                         0x01,
			},
		},
		{
			Code: "push5  0x01  0x02  0x03  0x04  0x05                                                                                                                                                                    add",
			Expected: []byte{
				0x64, 0x01, 0x02, 0x03, 0x04, 0x05,                                                                                                                                                                   0x01,
			},
		},
		{
			Code: "push6  0x01  0x02  0x03  0x04  0x05  0x06                                                                                                                                                              add",
			Expected: []byte{
				0x65, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,                                                                                                                                                             0x01,
			},
		},
		{
			Code: "push7  0x01  0x02  0x03  0x04  0x05  0x06  0x07                                                                                                                                                        add",
			Expected: []byte{
				0x66, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,                                                                                                                                                       0x01,
			},
		},
		{
			Code: "push8  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08                                                                                                                                                  add",
			Expected: []byte{
				0x67, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,                                                                                                                                                 0x01,
			},
		},
		{
			Code: "push9  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09                                                                                                                                            add",
			Expected: []byte{
				0x68, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09,                                                                                                                                           0x01,
			},
		},
		{
			Code: "push10 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a                                                                                                                                      add",
			Expected: []byte{
				0x69, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a,                                                                                                                                     0x01,
			},
		},
		{
			Code: "push11 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b                                                                                                                                add",
			Expected: []byte{
				0x6a, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b,                                                                                                                               0x01,
			},
		},
		{
			Code: "push12 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c                                                                                                                          add",
			Expected: []byte{
				0x6b, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c,                                                                                                                         0x01,
			},
		},
		{
			Code: "push13 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d                                                                                                                    add",
			Expected: []byte{
				0x6c, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d,                                                                                                                   0x01,
			},
		},
		{
			Code: "push14 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e                                                                                                              add",
			Expected: []byte{
				0x6d, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e,                                                                                                             0x01,
			},
		},
		{
			Code: "push15 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f                                                                                                        add",
			Expected: []byte{
				0x6e, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,                                                                                                       0x01,
			},
		},
		{
			Code: "push16 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10                                                                                                  add",
			Expected: []byte{
				0x6f, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10,                                                                                                 0x01,
			},
		},
		{
			Code: "push17 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11                                                                                            add",
			Expected: []byte{
				0x70, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11,                                                                                           0x01,
			},
		},
		{
			Code: "push18 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12                                                                                      add",
			Expected: []byte{
				0x71, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12,                                                                                     0x01,
			},
		},
		{
			Code: "push19 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13                                                                                add",
			Expected: []byte{
				0x72, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13,                                                                               0x01,
			},
		},
		{
			Code: "push20 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14                                                                          add",
			Expected: []byte{
				0x73, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14,                                                                         0x01,
			},
		},
		{
			Code: "push21 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15                                                                    add",
			Expected: []byte{
				0x74, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15,                                                                   0x01,
			},
		},
		{
			Code: "push22 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16                                                              add",
			Expected: []byte{
				0x75, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16,                                                             0x01,
			},
		},
		{
			Code: "push23 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17                                                        add",
			Expected: []byte{
				0x76, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,                                                       0x01,
			},
		},
		{
			Code: "push24 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18                                                  add",
			Expected: []byte{
				0x77, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18,                                                 0x01,
			},
		},
		{
			Code: "push25 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19                                            add",
			Expected: []byte{
				0x78, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19,                                           0x01,
			},
		},
		{
			Code: "push26 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a                                      add",
			Expected: []byte{
				0x79, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a,                                     0x01,
			},
		},
		{
			Code: "push27 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b                                add",
			Expected: []byte{
				0x7a, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b,                               0x01,
			},
		},
		{
			Code: "push28 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c                          add",
			Expected: []byte{
				0x7b, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c,                         0x01,
			},
		},
		{
			Code: "push29 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d                    add",
			Expected: []byte{
				0x7c, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d,                   0x01,
			},
		},
		{
			Code: "push30 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d  0x1e              add",
			Expected: []byte{
				0x7d, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e,             0x01,
			},
		},
		{
			Code: "push31 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d  0x1e  0x1f        add",
			Expected: []byte{
				0x7e, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,       0x01,
			},
		},
		{
			Code: "push32 0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0a  0x0b  0x0c  0x0d  0x0e  0x0f  0x10  0x11  0x12  0x13  0x14  0x15  0x16  0x17  0x18  0x19  0x1a  0x1b  0x1c  0x1d  0x1e  0x1f  0x20  add",
			Expected: []byte{
				0x7f, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f, 0x20, 0x01,
			},
		},



		{
			Code: "stop",
			Expected: []byte{
				0x00,
			},
		},
		{
			Code: "add",
			Expected: []byte{
				0x01,
			},
		},
		{
			Code: "mul",
			Expected: []byte{
				0x02,
			},
		},
		{
			Code: "sub",
			Expected: []byte{
				0x03,
			},
		},
		{
			Code: "div",
			Expected: []byte{
				0x04,
			},
		},
		{
			Code: "sdiv",
			Expected: []byte{
				0x05,
			},
		},
		{
			Code: "mod",
			Expected: []byte{
				0x06,
			},
		},
		{
			Code: "smod",
			Expected: []byte{
				0x07,
			},
		},
		{
			Code: "addmod",
			Expected: []byte{
				0x08,
			},
		},
		{
			Code: "mulmod",
			Expected: []byte{
				0x09,
			},
		},
		{
			Code: "exp",
			Expected: []byte{
				0x0a,
			},
		},
		{
			Code: "signextend",
			Expected: []byte{
				0x0b,
			},
		},

		{
			Code: "lt",
			Expected: []byte{
				0x10,
			},
		},
		{
			Code: "gt",
			Expected: []byte{
				0x11,
			},
		},
		{
			Code: "slt",
			Expected: []byte{
				0x12,
			},
		},
		{
			Code: "sgt",
			Expected: []byte{
				0x13,
			},
		},
		{
			Code: "eq",
			Expected: []byte{
				0x14,
			},
		},
		{
			Code: "iszero",
			Expected: []byte{
				0x15,
			},
		},
		{
			Code: "and",
			Expected: []byte{
				0x16,
			},
		},
		{
			Code: "or",
			Expected: []byte{
				0x17,
			},
		},
		{
			Code: "xor",
			Expected: []byte{
				0x18,
			},
		},
		{
			Code: "not",
			Expected: []byte{
				0x19,
			},
		},
		{
			Code: "byte",
			Expected: []byte{
				0x1a,
			},
		},

		{
			Code: "sha3",
			Expected: []byte{
				0x20,
			},
		},

		{
			Code: "address",
			Expected: []byte{
				0x30,
			},
		},
		{
			Code: "balance",
			Expected: []byte{
				0x31,
			},
		},
		{
			Code: "origin",
			Expected: []byte{
				0x32,
			},
		},
		{
			Code: "caller",
			Expected: []byte{
				0x33,
			},
		},
		{
			Code: "callvalue",
			Expected: []byte{
				0x34,
			},
		},
		{
			Code: "calldataload",
			Expected: []byte{
				0x35,
			},
		},
		{
			Code: "calldatasize",
			Expected: []byte{
				0x36,
			},
		},
		{
			Code: "calldatacopy",
			Expected: []byte{
				0x37,
			},
		},
		{
			Code: "codesize",
			Expected: []byte{
				0x38,
			},
		},
		{
			Code: "codecopy",
			Expected: []byte{
				0x39,
			},
		},
		{
			Code: "gasprice",
			Expected: []byte{
				0x3a,
			},
		},
		{
			Code: "extcodesize",
			Expected: []byte{
				0x3b,
			},
		},
		{
			Code: "extcodecopy",
			Expected: []byte{
				0x3c,
			},
		},

		{
			Code: "blockhash",
			Expected: []byte{
				0x40,
			},
		},
		{
			Code: "coinbase",
			Expected: []byte{
				0x41,
			},
		},
		{
			Code: "timestamp",
			Expected: []byte{
				0x42,
			},
		},
		{
			Code: "number",
			Expected: []byte{
				0x43,
			},
		},
		{
			Code: "difficulty",
			Expected: []byte{
				0x44,
			},
		},
		{
			Code: "gaslimit",
			Expected: []byte{
				0x45,
			},
		},

		{
			Code: "pop",
			Expected: []byte{
				0x50,
			},
		},
		{
			Code: "mload",
			Expected: []byte{
				0x51,
			},
		},
		{
			Code: "mstore",
			Expected: []byte{
				0x52,
			},
		},
		{
			Code: "mstore8",
			Expected: []byte{
				0x53,
			},
		},
		{
			Code: "sload",
			Expected: []byte{
				0x54,
			},
		},
		{
			Code: "sstore",
			Expected: []byte{
				0x55,
			},
		},
		{
			Code: "jump",
			Expected: []byte{
				0x56,
			},
		},
		{
			Code: "jumpi",
			Expected: []byte{
				0x57,
			},
		},
		{
			Code: "pc",
			Expected: []byte{
				0x58,
			},
		},
		{
			Code: "msize",
			Expected: []byte{
				0x59,
			},
		},
		{
			Code: "gas",
			Expected: []byte{
				0x5a,
			},
		},
		{
			Code: "jumpdest",
			Expected: []byte{
				0x5b,
			},
		},

		{
			Code: "dup1",
			Expected: []byte{
				0x80,
			},
		},
		{
			Code: "dup2",
			Expected: []byte{
				0x81,
			},
		},
		{
			Code: "dup3",
			Expected: []byte{
				0x82,
			},
		},
		{
			Code: "dup4",
			Expected: []byte{
				0x83,
			},
		},
		{
			Code: "dup5",
			Expected: []byte{
				0x84,
			},
		},
		{
			Code: "dup6",
			Expected: []byte{
				0x85,
			},
		},
		{
			Code: "dup7",
			Expected: []byte{
				0x86,
			},
		},
		{
			Code: "dup8",
			Expected: []byte{
				0x87,
			},
		},
		{
			Code: "dup9",
			Expected: []byte{
				0x88,
			},
		},
		{
			Code: "dup10",
			Expected: []byte{
				0x89,
			},
		},
		{
			Code: "dup11",
			Expected: []byte{
				0x8a,
			},
		},
		{
			Code: "dup12",
			Expected: []byte{
				0x8b,
			},
		},
		{
			Code: "dup13",
			Expected: []byte{
				0x8c,
			},
		},
		{
			Code: "dup14",
			Expected: []byte{
				0x8d,
			},
		},
		{
			Code: "dup15",
			Expected: []byte{
				0x8e,
			},
		},
		{
			Code: "dup16",
			Expected: []byte{
				0x8f,
			},
		},
		{
			Code: "swap1",
			Expected: []byte{
				0x90,
			},
		},
		{
			Code: "swap2",
			Expected: []byte{
				0x91,
			},
		},
		{
			Code: "swap3",
			Expected: []byte{
				0x92,
			},
		},
		{
			Code: "swap4",
			Expected: []byte{
				0x93,
			},
		},
		{
			Code: "swap5",
			Expected: []byte{
				0x94,
			},
		},
		{
			Code: "swap6",
			Expected: []byte{
				0x95,
			},
		},
		{
			Code: "swap7",
			Expected: []byte{
				0x96,
			},
		},
		{
			Code: "swap8",
			Expected: []byte{
				0x97,
			},
		},
		{
			Code: "swap9",
			Expected: []byte{
				0x98,
			},
		},
		{
			Code: "swap10",
			Expected: []byte{
				0x99,
			},
		},
		{
			Code: "swap11",
			Expected: []byte{
				0x9a,
			},
		},
		{
			Code: "swap12",
			Expected: []byte{
				0x9b,
			},
		},
		{
			Code: "swap13",
			Expected: []byte{
				0x9c,
			},
		},
		{
			Code: "swap14",
			Expected: []byte{
				0x9d,
			},
		},
		{
			Code: "swap15",
			Expected: []byte{
				0x9e,
			},
		},
		{
			Code: "swap16",
			Expected: []byte{
				0x9f,
			},
		},
		{
			Code: "log0",
			Expected: []byte{
				0xa0,
			},
		},
		{
			Code: "log1",
			Expected: []byte{
				0xa1,
			},
		},
		{
			Code: "log2",
			Expected: []byte{
				0xa2,
			},
		},
		{
			Code: "log3",
			Expected: []byte{
				0xa3,
			},
		},
		{
			Code: "log4",
			Expected: []byte{
				0xa4,
			},
		},

		{
			Code: "create",
			Expected: []byte{
				0xf0,
			},
		},
		{
			Code: "call",
			Expected: []byte{
				0xf1,
			},
		},
		{
			Code: "callcode",
			Expected: []byte{
				0xf2,
			},
		},
		{
			Code: "return",
			Expected: []byte{
				0xf3,
			},
		},
		{
			Code: "delegatecall",
			Expected: []byte{
				0xf4,
			},
		},

		{
			Code: "suicide",
			Expected: []byte{
				0xff,
			},
		},
	}


	for testNumber, test := range tests {

		var buffer bytes.Buffer

		if err := Assemble(&buffer, strings.NewReader(test.Code)); nil != err {
			t.Errorf("For test #%d, (for %q) did not expect an error, but actually got one: (%T) %q", testNumber, test.Code, err, err)
			continue
		}

		if expected, actual := string(test.Expected), buffer.String(); expected != actual {
			t.Errorf("For test #%d, (for %q)...", testNumber, test.Code)
			t.Errorf("    EXPECTED: %#v", test.Expected)
			t.Errorf("    ACTUAL:   %#v", buffer.Bytes())
			continue
		}
	}
}
